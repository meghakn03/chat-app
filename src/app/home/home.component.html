<div class="container">
  <header class="header">
    <h1>CH!ME</h1>
    <div class="header-buttons">
      <button (click)="logout()">Log Out</button>
      <button (click)="goToAccount()">Account</button>
      <button (click)="toggleFriendsList()" class="toggle-friends-button">
        <span *ngIf="!isFriendsListCollapsed">Hide Friends</span>
        <span *ngIf="isFriendsListCollapsed">Show Friends</span>
      </button>
    </div>
  </header>
  <div class="main-content">
    <aside [ngClass]="{'friends-list': true, 'collapsed': isFriendsListCollapsed}">
      <h2>Friends</h2>
      <input type="text" [(ngModel)]="searchTerm" (keyup.enter)="searchUsers()" placeholder="Search friends..." class="search-bar" />
      <button (click)="toggleAllUsers()">
        {{ showAllUsers ? 'Hide All Users' : 'Show All Users' }}
      </button>
      <ul>
        <li *ngFor="let friend of filteredFriends" (click)="selectFriend(friend)">
          {{ friend.username }}
          <button *ngIf="showAllUsers && !friend.isFriend" (click)="addFriend(friend)">Add as Friend</button>
          <span *ngIf="showAllUsers && friend.isFriend">Already a friend</span>
        </li>
      </ul>
    </aside>
    <section class="chat-area">
      <div class="chat-header">
        <h2>{{ selectedFriend ? selectedFriend.username : 'Select a friend' }}</h2>
      </div>
      <div class="chat-messages" >
      <div class="chat-messages" #chatContainer>
        <div *ngFor="let msg of messages" [ngClass]="{'sent': msg.senderId === loggedInUserId, 'received': msg.senderId !== loggedInUserId}">
          <p>{{ msg.text }}</p>
          <small>{{ msg.timestamp | date: 'shortTime' }}</small> <!-- Display time -->
        </div>
      </div> 
    </div>     
      <div class="chat-input">
        <input
        type="text"
        [(ngModel)]="message"
        (keydown.enter)="sendMessage()" 
        placeholder="Type your message..."
      />        
      <button (click)="sendMessage()">Send</button>
      </div>
    </section>
  </div>
</div>
